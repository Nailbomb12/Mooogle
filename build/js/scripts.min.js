"use strict";var result=document.querySelector(".videos"),idInput=document.querySelector("#idInput"),htmlTempl=document.querySelector("#Extendcard").textContent.trim(),compile=_.template(htmlTempl),htmlTpl=document.querySelector("#card").textContent.trim(),compiled=_.template(htmlTpl),htmlTplTV=document.querySelector("#cardTV").textContent.trim(),compil=_.template(htmlTplTV),htmlTemplTvCard=document.querySelector("#ExtendcardTV").textContent.trim(),compileTvCard=_.template(htmlTemplTvCard),apiKey="532f680f186ee3009db06b2e2efe9aab",updateView=function(e,t,a){var i="";e.forEach(function(e){i+=a(e)}),t.innerHTML=i},getPopular=function(e,t,a){axios.get("https://api.themoviedb.org/3/"+e+"/popular?api_key="+apiKey+"&language=ru-RU&page=1").then(function(e){updateView(e.data.results,t,a)}).catch(function(e){console.log(e)})},searchByName=function(e){axios.get("https://api.themoviedb.org/3/search/movie?include_adult=false&page=1&query="+e+"&language=ru-RU&api_key="+apiKey).then(function(e){updateView(e.data.results,result,compiled)}).catch(function(e){console.log(e)})},showMovie=function(e){return renderFullCard(e,"movie")},showTV=function(e){return renderFullCardTV(e,"tv")},updateViewMovieCard=function(e,t,a){var i=a(e);t.innerHTML=i},renderFullCard=function(e,t){axios.get("https://api.themoviedb.org/3/"+t+"/"+e+"?language=ru-RU&api_key="+apiKey).then(function(a){var i=a.data,o=i.genres,r=i.overview,s=i.poster_path,n=i.production_countries,c=i.release_date,d=i.runtime,l=i.tagline,u=i.title;axios.get("https://api.themoviedb.org/3/"+t+"/"+e+"/images?api_key="+apiKey).then(function(a){var i=a.data.backdrops;axios.get("https://api.themoviedb.org/3/"+t+"/"+e+"/credits?language=ru-RU&api_key="+apiKey).then(function(a){var p=a.data,h=p.cast,m=p.crew;axios.get("https://api.themoviedb.org/3/"+t+"/"+e+"/videos?api_key="+apiKey).then(function(e){var t=e.data.results[0].key;updateViewMovieCard({title:u,genres:o,overview:r,poster:s,countries:n,date:c,runtime:d,tagline:l,backdrops:i,cast:h,crew:m,key:t},result,compile)})}).catch(function(e){console.log(e)})}).catch(function(e){console.log(error)})}).catch(function(e){console.log(e)})},renderFullCardTV=function(e,t){axios.get("https://api.themoviedb.org/3/"+t+"/"+e+"?language=ru-RU&api_key="+apiKey).then(function(a){var i=a.data,o=i.name,r=i.genres,s=i.overview,n=i.poster_path,c=i.origin_country,d=i.first_air_date,l=i.episode_run_time,u=i.created_by,p=i.number_of_seasons,h=i.last_air_date,m=i.number_of_episodes,v=i.original_name,g=i.homepage;axios.get("https://api.themoviedb.org/3/"+t+"/"+e+"/images?api_key="+apiKey).then(function(a){var i=a.data.backdrops;axios.get("https://api.themoviedb.org/3/"+t+"/"+e+"/credits?language=ru-RU&api_key="+apiKey).then(function(a){var y=a.data.cast;axios.get("https://api.themoviedb.org/3/"+t+"/"+e+"/videos?api_key="+apiKey).then(function(e){var t=e.data.results[0].key;updateViewMovieCard({title:o,date:d,poster:n,backdrops:i,countries:c,cast:y,created_by:u,genres:r,runtime:l,overview:s,key:t,number_of_seasons:p,last_air_date:h,number_of_episodes:m,original_name:v,homepage:g},serials,compileTvCard)})}).catch(function(e){console.log(e)})}).catch(function(e){console.log(error)})}).catch(function(e){console.log(e)})};getPopular("movie",result,compiled);var menu=document.querySelector(".header__menu"),stub=document.querySelector(".stub"),aside=document.querySelector(".aside"),asideList=document.querySelector(".aside__list"),asideItem=document.querySelectorAll(".aside__item"),asideLink=document.querySelectorAll(".aside__link"),tabs=document.querySelector(".category-list"),tabLinks=document.querySelectorAll(".category-item"),tabsPane=document.querySelectorAll(".tabs__pane"),serials=document.querySelector(".tv-serials"),hiddenBlockIcon=document.querySelector(".hidden-search"),hiddenBlock=document.querySelector(".hidden");tabLinks[0].classList.add("category-item--active"),tabsPane[0].classList.add("tabs__pane--active");var toggleAside=function(){aside.classList.toggle("js-show-aside"),stub.classList.add("js-show-stub"),document.body.classList.add("ovfh")};menu.addEventListener("click",toggleAside);var toggleHiddenBlock=function(){hiddenBlock.classList.toggle("js-show-hidden"),stub.classList.add("js-show-stub"),document.body.classList.add("ovfh")};hiddenBlockIcon.addEventListener("click",toggleHiddenBlock);var hideBlocks=function(e){stub.classList.contains("js-show-stub")&&(hiddenBlock.classList.remove("js-show-hidden"),aside.classList.remove("js-show-aside"),stub.classList.remove("js-show-stub"),document.body.classList.remove("ovfh"))};stub.addEventListener("click",hideBlocks);var searchBtn=document.querySelector(".idBtn"),headerSearch=function(e){e.preventDefault(0),e.target.classList.contains("idBtn")&&searchByName(idInput.value),idInput.value},switchTabs=function(e){if(e.preventDefault(),e.target!==tabs){tabLinks.forEach(function(e){return e.classList.remove("category-item--active")}),e.target.classList.add("category-item--active"),tabsPane.forEach(function(e){return e.classList.remove("tabs__pane--active")});var t=!0,a=!1,i=void 0;try{for(var o,r=tabsPane[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var s=o.value;e.target.getAttribute("href")==="#"+s.id&&s.classList.add("tabs__pane--active"),"#pane-1"===e.target.getAttribute("href")&&getPopular("movie",result,compiled),"#pane-2"===e.target.getAttribute("href")&&getPopular("tv",serials,compil)}}catch(e){a=!0,i=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw i}}}};tabs.addEventListener("click",switchTabs),searchBtn.addEventListener("click",headerSearch);var switchAsideCategorys=function(e){if(e.target.classList.contains("aside__link")){tabsPane.forEach(function(e){return e.classList.remove("tabs__pane--active")});var t=!0,a=!1,i=void 0;try{for(var o,r=tabsPane[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var s=o.value;e.target.getAttribute("href")==="#"+s.id&&s.classList.add("tabs__pane--active"),hideBlocks()}}catch(e){a=!0,i=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw i}}}};asideList.addEventListener("click",switchAsideCategorys);